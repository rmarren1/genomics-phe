
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Fast Paillier &#8212; GenomicsPHE 0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fast-paillier">
<h1>Fast Paillier<a class="headerlink" href="#fast-paillier" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction-to-the-paillier-cryptosystem">
<h2>Introduction to the Paillier Cryptosystem<a class="headerlink" href="#introduction-to-the-paillier-cryptosystem" title="Permalink to this headline">¶</a></h2>
<p>The Paillier cryptosystem is an probabilistic asymmetric algorithm for
public key cryptography, designed in 1999 by Pascal Paillier.</p>
<p>This cryptosystem has the important property that it is homomorphic in
its addition operator. Explicitly, if <span class="math">\(\alpha\)</span>, <span class="math">\(\beta\)</span>, and
<span class="math">\(\xi\)</span> are scalars, <span class="math">\(a\)</span> and <span class="math">\(b\)</span> are two plaintexts, and
<span class="math">\(Enc(a)\)</span>, <span class="math">\(Enc(b)\)</span> are the encryption of <span class="math">\(a\)</span> and
<span class="math">\(b\)</span> under the same public key, then
<span class="math">\(D(\alpha E(a) + \beta E(b) + \xi) = \alpha D(E(a)) + \beta D(E(b)) + \xi\)</span>
where <span class="math">\(D\)</span> is the decryption under the secret key. This means that
operations of scalar multiplication, scalar addition, and element-wise
addition in the ciphertext-space are preserved in the message-space
after encryption.</p>
<p>This means that an untrusted third party could perform a limited set of
computations on the encrypted data without ever finding out what the
data is. For example, Alice could generate a key pair <span class="math">\((p, s)\)</span> and
send Bob a list of numbers <span class="math">\(X = [x_1, x_2, \ldots, x_n]\)</span> encrypted
under her public key,
<span class="math">\(E_p(X) = [E_p(x_1), E_p(x_2), \ldots, E_p(x_n)]\)</span>. She could then
ask Bob to take the mean of these numbers and return the result
<span class="math">\(S = \frac{1}{n} \sum_{i = 1}^n E_p(x_i)\)</span>. Bob learned nothing
about the <span class="math">\(X\)</span> from doing this, but given <span class="math">\(S\)</span>, Alice could
compute
<span class="math">\(D_s(S) = D_s(\frac{1}{n}\sum_{i=1}^nE_p(x_i)) = \frac{1}{n}\sum_{i=1}^nD_s(E_p(x_i)) = \frac{1}{n}\sum_{i=1}^n x_i\)</span>
and obtain the correct mean value.</p>
</div>
<div class="section" id="vector-operations-with-paillier">
<h2>Vector Operations with Paillier<a class="headerlink" href="#vector-operations-with-paillier" title="Permalink to this headline">¶</a></h2>
<p>Suppose <span class="math">\(x \in \mathbb{Z}^D\)</span> is a <span class="math">\(D\)</span>-dimensional vector. We
can extend the Paillier cryptosystem to do some structure preserving
operations on vectors.</p>
<p>Suppose again Alice has a key pair <span class="math">\((p, s)\)</span>. If
<span class="math">\(\vec{x} = [x_1, x_2, \ldots, x_D]^T\)</span>, we can define
<span class="math">\(E_p(\vec{x}) = [E_p(x_1), E_p(x_2), \ldots, E_p(x_D)]^T\)</span>. With
this definition, we can perform similar operations to those described in
the indroduction on vectors instead of values in <span class="math">\(\mathbb{R}\)</span>. For
example, if
<span class="math">\(X = \big( \, \vec{x_1} \big| \vec{x_2} \big| \ldots \big| \vec{x_n} \, \big)\)</span>
is a matrix in <span class="math">\(\mathbb{R}^{D \times n}\)</span>, Alice can encrypt this
entire matrix by encrypting each vector individually. Then Alice can
send the encrypted matrix
<span class="math">\(E_p(X) = \big( \, E_p(\vec{x_1}) \big| E_p(\vec{x_2}) \big| \ldots \big| E_p(\vec{x_n}) \, \big)\)</span>
to Bob and have him compute the row-wise mean
<span class="math">\(E_p(\vec{\mu}) = \frac{1}{n}\sum_{i = 1}^n E_p(\vec{x}_i)\)</span>.
Finally, Alice can decrypt <span class="math">\(D_s(E_p(\vec{\mu})) = \vec{\mu}\)</span> to
get the result.</p>
</div>
<div class="section" id="inefficiencies-with-small-messages">
<h2>Inefficiencies with Small Messages<a class="headerlink" href="#inefficiencies-with-small-messages" title="Permalink to this headline">¶</a></h2>
<p>The encryption operation <span class="math">\(E_p(m)\)</span> in the Paillier cryptosystem is
explicitely <span class="math">\(E_p(m) = g^m r^n \mod n^2\)</span> where
<span class="math">\(g \in \mathbb{Z}_{n^2}^*\)</span> and <span class="math">\(r \in \mathbb{Z}\)</span> is a
random number.</p>
<p>Since the secret key <span class="math">\(s\)</span> is easy to compute with the factorization
of <span class="math">\(N = pq\)</span>, like in RSA, we must choose large moduli (e.g. N =
2048 bits) to avoid brute force factoring attacks. But according to the
original paper, the Paillier cryptosystem is safe to use with plaintexts
<span class="math">\(m \in \mathbb{Z}^{\frac{N}{3} - 1}\)</span>. This leads to major
inefficiencies in some specific use cases. Here is an example of the
problem:</p>
<p>Suppose Alice now has a matrix <span class="math">\(M \in \{0, 1\}^{\{D, n\}}\)</span> where
<span class="math">\(D &gt;&gt; n\)</span> and <span class="math">\(n &lt;&lt; N\)</span>. This is a common setting in Genomic
studies, where <span class="math">\(D \approx 28e6\)</span>, <span class="math">\(n \approx 100\)</span>, and
<span class="math">\(M_{i, j} = 1\)</span> if subject <span class="math">\(j\)</span> has mutation <span class="math">\(i\)</span>, else
<span class="math">\(0\)</span>.</p>
<p>If Alice wants to now find the the row sum of her data (the count of
each mutation in the entire cohort of <span class="math">\(n\)</span> subjects), she will need
to perform the expensive encryption operation on every entry in the
matrix <span class="math">\(M\)</span> even though she only required <span class="math">\(N\)</span> to avoid brute
force attacks and is not at all taking advantage of the fact that the
encryption scheme works for values in
<span class="math">\(m \in \mathbb{Z}^{\frac{N}{3} - 1}\)</span> (since the highest possible
value she can have in her result is <span class="math">\(100\)</span>).</p>
<p>Empirically, we can see the this is a large slow down.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">phe</span> <span class="k">import</span> <span class="n">paillier</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">gphe.vecphe</span> <span class="k">as</span> <span class="nn">vphe</span>
<span class="n">p</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">paillier</span><span class="o">.</span><span class="n">generate_paillier_keypair</span><span class="p">()</span>
<span class="n">D</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(D, n) =&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">E_Mslow</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">matEnc</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mf">30.6</span> <span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">28</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">30.6</span> <span class="n">s</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">30.9</span> <span class="n">s</span>
</pre></div>
</div>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bash</span>
<span class="n">screenfetch</span>
</pre></div>
</div>
<pre class="literal-block">
[0m[1;31m                          ./+o+-       [0m[1;31mryan[0m[1m&#64;[0m[0m[1;31mgalliumos[0m
[0m[1;37m                  yyyyy- [0m[1;31m-yyyyyy+     [0m[1;31m OS:[0m Ubuntu 16.04 xenial[0m
[0m[1;37m               [0m[1;37m://+//////[0m[1;31m-yyyyyyo     [0m[1;31m Kernel:[0m x86_64 Linux 4.9.4-galliumos-braswell[0m
[0m[1;33m           .++ [0m[1;37m.:/++++++/-[0m[1;31m.+sss/`     [0m[1;31m Uptime:[0m 3h 48m[0m
[0m[1;33m         .:++o:  [0m[1;37m/++++++++/:--:/-     [0m[1;31m Packages:[0m 1830[0m
[0m[1;33m        o:+o+:++.[0m[1;37m`..```.-/oo+++++/    [0m[1;31m Shell:[0m bash 4.3.48[0m
[0m[1;33m       .:+o:+o/.[0m[1;37m          <cite>+sssoo+/   [0m[1;31m Resolution:[0m 1920x1080[0m
[0m[1;37m  .++/+:[0m[1;33m+oo+o:`[0m[1;37m             /sssooo.  [0m[1;31m DE:[0m XFCE[0m
[0m[1;37m /+++//+:[0m[1;33m`oo+o[0m[1;37m               /::--:.  [0m[1;31m WM:[0m Xfwm4[0m
[0m[1;37m +/+o+++[0m[1;33m`o++o[0m[1;31m               ++////.  [0m[1;31m WM Theme:[0m Arc-Darker-GalliumOS[0m
[0m[1;37m  .++.o+[0m[1;33m++oo+:`[0m[1;31m             /dddhhh.  [0m[1;31m GTK Theme:[0m Arc-GalliumOS [GTK2][0m
[0m[1;33m       .+.o+oo:.[0m[1;31m          `oddhhhh+   [0m[1;31m Icon Theme:[0m Numix-Circle-GalliumOS[0m
[0m[1;33m        +.++o+o`[0m[1;31m</cite>-<a href="#id1"><span class="problematic" id="id2">``</span></a><code class="docutils literal"><span class="pre">.:ohdhhhhh+</span>&#160;&#160;&#160; <span class="pre">[0m[1;31m</span> <span class="pre">Font:[0m</span> <span class="pre">Roboto</span> <span class="pre">10[0m</span>
<span class="pre">[0m[1;33m</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">`:o+++</span> <span class="pre">[0m[1;31m`ohhhhhhhhyo++os:</span>&#160;&#160;&#160;&#160; <span class="pre">[0m[1;31m</span> <span class="pre">CPU:[0m</span> <span class="pre">Intel</span> <span class="pre">Celeron</span> <span class="pre">CPU</span> <span class="pre">N3160</span> <span class="pre">&#64;</span> <span class="pre">1.601GHz[0m</span>
<span class="pre">[0m[1;33m</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">.o:[0m[1;31m`.syhhhhhhh/[0m[1;33m.oo++o`</span>&#160;&#160;&#160;&#160; <span class="pre">[0m[1;31m</span> <span class="pre">RAM:[0m</span> <span class="pre">1747MiB</span> <span class="pre">/</span> <span class="pre">3900MiB[0m</span>
<span class="pre">[0m[1;31m</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">/osyyyyyyo[0m[1;33m++ooo+++/</span>&#160;&#160;&#160; <span class="pre">[0m</span>
<span class="pre">[0m[1;31m</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">```</span></code> [0m[1;33m+oo+++o:    [0m
[0m[1;33m                          <a href="#id3"><span class="problematic" id="id4">`</span></a>oo++.      [0m
</pre>
<p>As you can see, the process of encrypting such a matrix where
<span class="math">\(D = 128\)</span> and <span class="math">\(n = 4\)</span> (which is very small) takes 30
seconds. Even on better hardware (as you can see, we are not working
with a powerhouse here), it is unlikely that a larger genomic study
where <span class="math">\(D\)</span> is in the millions and <span class="math">\(n\)</span> is in the hundreds is
going to finish any time soon.</p>
</div>
<div class="section" id="speeding-things-up">
<h2>Speeding Things Up<a class="headerlink" href="#speeding-things-up" title="Permalink to this headline">¶</a></h2>
<p>The reason this experiment went so poorly is because our data structure
was not taking advantage of the large amount of numbers encrypted values
could take on. We fix this as follows:</p>
<p>Consider the mapping</p>
<div class="math">
\[f_{b, l}: \{0, 1\}^{\{D, n\}} \rightarrow \mathbb{Z}^{\{d, n\}}\]</div>
<p>parameterized by a base size variable <span class="math">\(b\)</span> and a block length
variable <span class="math">\(l\)</span>. We define</p>
<div class="math">
\[ \begin{align}\begin{aligned}g_{b}: \{0, 1\}^l \rightarrow \mathbb{Z}_b, \,\, g(\vec{x}) = \sum_{i = 0}^{l - 1} x_{i + 1} b^i\\and\end{aligned}\end{align} \]</div>
<div class="math">
\[z_{b, l}: \{0, 1\}^{l, n} \rightarrow \mathbb{Z}_b^n, \,\, z_b(M, i) = [g_{b}(M[i:i+l, 1]), g_{b}(M[i:i+l, 1]), \ldots, g_{b}(M[i:i+l, n])]\]</div>
<p>.</p>
<p>We take</p>
<div class="math">
\[f_{b, l}(M) = \bigg(z_{b, l}(M, 0)^T, z_{b, l}(M, l)^T, \ldots, z_{b, l}(M, \frac{n}{l})^T  \bigg)^T\]</div>
<p>The point here is that <span class="math">\(f\)</span> is an isomorphism since <span class="math">\(g\)</span> is
invertible, but <span class="math">\(d &lt;&lt; D\)</span>.</p>
<p>We test this experiment with: * <span class="math">\(b = 128\)</span> * <span class="math">\(l = 128\)</span> *
<span class="math">\(D = 128\)</span> * <span class="math">\(n = 4\)</span> * <span class="math">\(d = 4\)</span></p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">E_Mfast</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">fmatEnc</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mf">1.13</span> <span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">29</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">1.15</span> <span class="n">s</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.21</span> <span class="n">s</span>
</pre></div>
</div>
<p>As we can see, this new encryption scheme ran much faster at at over a
1000x speedup. Decryption time is also improved with this scheme, as we
can see below.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">Mslow</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">matDec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">E_Mslow</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mf">8.76</span> <span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">12</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">8.77</span> <span class="n">s</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">8.95</span> <span class="n">s</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="n">Mfast</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">fmatDec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">E_Mfast</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mi">82</span> <span class="n">ms</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">1</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mi">83</span> <span class="n">ms</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">89.8</span> <span class="n">ms</span>
</pre></div>
</div>
<p>We see a similar speedup of around 1000x. Now we check to see if the
decrypted matrices are actually the same.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span> <span class="n">Mslow</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">==</span> <span class="n">Mfast</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
</pre></div>
</div>
<p>Now we run several tests to see how the Encryption plus Decryption times
very as a function of the number of points in the matrix for the Fast
and Slow schemes. We plot the results below.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">Ds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
<span class="n">ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
<span class="n">slowtimes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fasttimes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">numpoints</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">D</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Ds</span><span class="p">,</span> <span class="n">ns</span><span class="p">):</span>
    <span class="n">numpoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">D</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">E_Mslow</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">matEnc</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">Mslow</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">matDec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">E_Mslow</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">slowtimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">E_Mfast</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">fmatEnc</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">Mfast</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">fmatDec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">E_Mfast</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">fasttimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">numpoints</span><span class="p">,</span> <span class="n">slowtimes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pallier&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">numpoints</span><span class="p">,</span> <span class="n">fasttimes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;fastPaillier&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Points in Matrix&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Time Taken to Enc then Dec in Seconds&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pallier Enc+Dec vs. fastPallier Enc+Dec&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_16_0.png" src="_images/output_16_0.png" />
<p>We see that the fastPaillier schemes is performing much better than the
normal Paillier scheme. We continue the fastPaillier plot since it is
not prohibatively long, and see the general trend of the fast scheme.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">Ds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">)]</span>
<span class="n">ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">D</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Ds</span><span class="p">,</span> <span class="n">ns</span><span class="p">):</span>
    <span class="n">numpoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">D</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">E_Mfast</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">fmatEnc</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">Mfast</span> <span class="o">=</span> <span class="n">vphe</span><span class="o">.</span><span class="n">fmatDec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">E_Mfast</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">fasttimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">numpoints</span><span class="p">,</span> <span class="n">fasttimes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;fastPaillier&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Points in Matrix&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Time Taken to Enc then Dec in Seconds&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;fastPallier Enc+Dec Time Taken&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_19_0.png" src="_images/output_19_0.png" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Ryan Marren and John Wilson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/Demo.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>